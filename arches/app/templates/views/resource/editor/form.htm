{% load i18n %}
<!-- ko foreach: { data: cards, as: 'card' } -->
<!-- Card Manager Panels and Forms -->
<div class="ep-card-crud-container">
    <!-- Card Preview -->
    <div id="card-preview">

        <div id="" class="panel">
            <div class="panel-heading">
                <div class="">
                    <h3 id="cc-title" class="panel-title card-main-title" data-bind="text: card.get('name')"></h3>
                </div>
            </div>

            <!-- Data Entry -->
            <div id="card-preview-crud" class="panel-body card-body fade in" style="padding-top: 0px;">
                <div id="cards" class="tab-base outline relative" style="margin-bottom: 15px; margin-top: -2px;">
                    <!--Nav Tabs-->
                    <ul class="nav nav-tabs card-nav-container"  data-bind="foreach: {
                        data: card.isContainer() ? card.get('cards') : [card]
                    }">
                        <li id="summary-group" data-bind="css: {
                            'active': card.get('selectedCardIndex')()===$index()
                        }, click: card.get('selectedCard')">
                            <a id="summary-tab" href="#" class="card-tab-title">
                                <span data-bind="text: get('name')"></span>
                            </a>
                        </li>
                    </ul>

                    <div id="db-arches-app-alert" class="panel data-card-alert"></div>


                    <!--Tabs Content-->
                    <div class="tab-content card-content-tab" style="margin-left: 0px;">

                        <!-- ko foreach: {
                            data: card.isContainer() ? card.get('cards') : [card],
                            as: 'card'
                        } -->
                        <!-- Card -->
                        <div class="tab-pane fade" data-bind="css: {
                            'active in': $parent.get('selectedCardIndex')()===$index()
                        }">
                            <div class="panel-body card-panel-body">
                                <div id="" class="card-content">

                                    <div class="card-instructions">
                                        <span data-bind="text: card.get('instructions')"></span>

                                        <!-- Help link -->
                                        <span>
                                            <a class="pull-right card-help help editable-help" data-bind="visible: $parent.currentTabCard && $parent.currentTabCard.get('helpenabled'), click: function () { $parent.helpPreviewActive(true) }" style="display: none; cursor:pointer;"> Help <i class="fa fa-question-circle"></i></a>
                                        </span>
                                    </div>

                                    <!-- Form -->
                                    <div class="col-xs-12 card-form-container" style="">

                                        <form class="widgets row" style="margin-bottom: 20px;" data-bind="foreach: {
                                                data:card.get('widgets')
                                            }">
                                            <div class='widget-preview' data-bind='component: {
                                                name: $parents[2].widgetLookup[get("widget_id")()].name,
                                                params: {
                                                    config: configJSON,
                                                    label: get("label")(),
                                                    value: ko.observable(),
                                                    disabled: false
                                                }
                                            }'></div>
                                        </form>

                                        <!-- Save/Add Button -->
                                        <div id="card-save-tile-btn" class="install-buttons" data-bind="visible: card.get('cardinality')() === 'n'" style="display: none;">
                                            <button id="" class="btn btn-shim btn-mint btn-labeled btn-lg fa fa-plus">{% trans "Add" %}</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="card-save-tile-list" class="list-group" style="margin: 0px 15px 30px 10px; display: block;" data-bind="visible: card.get('cardinality')() === 'n'">

                                <!-- Title -->
                                <div class="card-tab-title mar-btm">
                                    Saved <span data-bind="text: card.get('name')"/>
                                </div>

                                <!-- Tiles -->
                                <div class="tile-record list-group-item" style="cursor: pointer; background: rgb(250, 250, 250); height: 40px;" data-bind="text: card.get('itemtext')">
                                </div>
                            </div>
                        </div>
                        <!-- /ko -->

                    </div>

                    <aside id="card-help-panel" class="card-help-panel" style="display: none;" data-bind="visible: $parent.helpPreviewActive">
                        <div class="relative">
                            <a id="add-basemap-wizard-help-close" href="#" class="help-close fa fa-times fa-lg" style="" data-bind="click: function () { $parent.helpPreviewActive(false) }"></a>
                        </div>
                        <div id="add-basemap-wizard-help-content">
                            <div>
                                <div class="panel-heading">
                                    <h3 class="panel-title" style="padding: 0 10px 0 10px;">
                                        <span class="help-text-small">Help</span>
                                        <span data-bind="text: $parent.currentTabCard ? $parent.currentTabCard.get('helptitle') : ''"></span>
                                    </h3>
                                </div>
                                <div class="panel-body" style="padding: 10px 10px 15px 10px;" data-bind="html: $parent.currentTabCard ? $parent.currentTabCard.get('helptext') : ''">
                                </div>
                            </div>
                        </div>
                    </aside>
                </div>

                <!-- Wizard Level Buttons -->
                <div class="ep-form-toolbar" style="background: transparent; border-bottom: none; padding-bottom: 20px;">
                    <div class="ep-form-toolbar-tools mar-no flex">
                        <span>
                            <button class="btn btn-danger btn-lg btn-labeled fa fa-trash">{% trans "Discard" %}</button>
                            <button class="btn btn-primary btn-lg btn-labeled fa fa-check">{% trans "Save" %}</button>
                        </span>
                    </div>
                </div>

                <div class="relative" style="margin-bottom: 0px; margin-top: 10px; padding-bottom: 10px;" data-bind="visible: card.get('cardinality')() === 'n' && card.isContainer()" style="display: none;">

                    <!-- Title -->
                    <div class="card-tab-title mar-btm">
                        Saved <span data-bind="text: card.get('name')"/>
                    </div>

                    <!-- Wizard Tile -->
                    <div id="wizard-tile-card" class="tab-base outline" style="margin-bottom: 20px; margin-top: -2px;">

                        <ul class="nav nav-tabs card-nav-container" data-bind="foreach: card.get('cards')" style="margin-bottom: 0px;">
                            <li id="summary-group" data-bind="css: {'active': $index() === card.get('selectedCardIndex')()}" style="margin-bottom: 0px;">
                                <a id="summary-tab" href="#" class="card-tab-title" data-bind="click: $parent.selection">
                                    <!-- Editable Span -->
                                    <span class="card-tab-title">
                                        <span data-bind="text: get('name')"></span>
                                    </span>
                                </a>
                            </li>
                            <li class="wizard-card-tools" data-bind="if: $index() === (card.isContainer() ? (card.get('cards')().length - 1) : 0) ">
                                <i class="ion-ios-trash add-tooltip library-tools-icon" data-placement="bottom" data-toggle="tooltip" data-original-title="Delete"></i>
                                <i class="ion-ios-loop-strong add-tooltip library-tools-icon" data-placement="bottom" data-toggle="tooltip" data-original-title="Show/Hide"></i>
                            </li>
                        </ul>
                    </div>

                </div>
            </div>


        </div>
    </div>
</div>
<!-- /ko -->

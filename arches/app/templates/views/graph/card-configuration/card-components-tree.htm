{% load i18n %}
<!-- ko foreach: { data: [$data], as: 'self' } -->
<div id="ep-card-tools">

    <!-- Toggle form/report TOC -->
    <div class="toc-title-block">
        <h4 class="title-block-title"> {% trans "Card Manager" %}</h4>
    </div>


    <!-- TOC Cards/Widgets -->
    <div id="card-management-forms">
        <!-- ko template: {
            name: 'card-tree',
            foreach: [card],
            as: 'card'
        } --> <!-- /ko -->
    </div>
</div>
<!-- /ko -->

<template id="card-tree">
    <li class="card-tree-list"data-bind="css: {
        'active': self.selection() === card
    }">
        <a href="#" class="cc-link" aria-expanded="true" data-bind="css: {
            'card-container-link': card.isContainer(),
            'card-link': !card.isContainer(),
            'active': self.selection() === card
        },
        click: self.selection">
            <i class="card-tree-list-icon" data-bind="css: {
                'ion-ios-folder-outline': card.isContainer(),
                'ion-ios-list-outline': !card.isContainer()
            }"></i>
            <span data-bind="text: card.get('name')"></span>
        </a>

        <ul class="card-tree-list-item" aria-expanded="true">
            <!-- ko template: {
                name: card.isContainer() ? 'card-tree' : 'card-tree-widgets',
                foreach: card.isContainer() ? get('cards') : get('widgets'),
                as: card.isContainer() ? 'card' : 'widget'
            } --> <!-- /ko -->
        </ul>
    </li>
</template>

<template id="card-tree-widgets">
    <li class="card-tree-list" data-bind="css: {
        'active': self.selection() === widget
    }">
        <a href="#" class="cc-link card-widget-link" data-bind="css: {
            'active': self.selection() === widget
        },
        click: self.selection">
            <i class="ion-ios-paper card-tree-list-icon"></i>
            <span data-bind="text: widget.get('label')"></span>
        </a>
    </li>
</template>
